<!DOCTYPE html><html lang="zh-CN" data-default-color-scheme="auto"><head><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png"><link rel="icon" href="/img/favicon.png"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests"><meta name="theme-color" content="#2f4154"><meta name="author" content="è¿æ€é‘«"><meta name="keywords" content="åšå®¢"><meta name="description" content="ã€ŠFreeRTOS å…¨æ ˆå·¥ç¨‹å®æˆ˜æ•™ç¨‹ã€‹ç¬¬2.1ç¯‡ï¼šSTM32 ç¯å¢ƒæ­å»º (CubeMX + Keil) ä¸å·¥ç¨‹çƒ§å½•å…¨æµç¨‹ â­ éš¾åº¦ç­‰çº§ï¼šâ˜…â˜†â˜† åŸºç¡€ æ ‡ç­¾ï¼šFreeRTOS, STM32, CubeMX, Keil, HAL, ç¯å¢ƒæ­å»º, ST-Link ğŸ“ å®æˆ˜é—®é¢˜åœºæ™¯ åœ¨ç¬¬0ç¯‡ä¸­ï¼Œæˆ‘ä»¬å‡†å¤‡å¥½äº†æ‰€æœ‰çš„â€œåŸææ–™â€ï¼ˆç¡¬ä»¶æ¿å¡ã€è½¯ä»¶å·¥å…·ï¼‰ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬é¢ä¸´ç€ç¬¬ä¸€ä¸ªâ€œå·¥ç¨‹â€é—®é¢˜ï¼š  â€œæˆ‘å¦‚ä½•å°†è¿™äº›ç‹¬ç«‹çš„"><meta property="og:type" content="article"><meta property="og:title" content="ã€ŠFreeRTOS å…¨æ ˆå·¥ç¨‹å®æˆ˜æ•™ç¨‹ã€‹ç¬¬2.1ç¯‡ï¼šSTM32 ç¯å¢ƒæ­å»º (CubeMX + Keil) ä¸å·¥ç¨‹çƒ§å½•å…¨æµç¨‹"><meta property="og:url" content="https://jinbilianshao.github.io/2025/10/25/%E3%80%8AFreeRTOS-%E5%85%A8%E6%A0%88%E5%B7%A5%E7%A8%8B%E5%AE%9E%E6%88%98%E6%95%99%E7%A8%8B%E3%80%8B%E7%AC%AC2-1%E7%AF%87%EF%BC%9ASTM32-%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA-CubeMX-Keil-%E4%B8%8E%E5%B7%A5%E7%A8%8B%E7%83%A7%E5%BD%95%E5%85%A8%E6%B5%81%E7%A8%8B/index.html"><meta property="og:site_name" content="è¿æ€é‘«çš„åšå®¢"><meta property="og:description" content="ã€ŠFreeRTOS å…¨æ ˆå·¥ç¨‹å®æˆ˜æ•™ç¨‹ã€‹ç¬¬2.1ç¯‡ï¼šSTM32 ç¯å¢ƒæ­å»º (CubeMX + Keil) ä¸å·¥ç¨‹çƒ§å½•å…¨æµç¨‹ â­ éš¾åº¦ç­‰çº§ï¼šâ˜…â˜†â˜† åŸºç¡€ æ ‡ç­¾ï¼šFreeRTOS, STM32, CubeMX, Keil, HAL, ç¯å¢ƒæ­å»º, ST-Link ğŸ“ å®æˆ˜é—®é¢˜åœºæ™¯ åœ¨ç¬¬0ç¯‡ä¸­ï¼Œæˆ‘ä»¬å‡†å¤‡å¥½äº†æ‰€æœ‰çš„â€œåŸææ–™â€ï¼ˆç¡¬ä»¶æ¿å¡ã€è½¯ä»¶å·¥å…·ï¼‰ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬é¢ä¸´ç€ç¬¬ä¸€ä¸ªâ€œå·¥ç¨‹â€é—®é¢˜ï¼š  â€œæˆ‘å¦‚ä½•å°†è¿™äº›ç‹¬ç«‹çš„"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2025-10-25T08:17:00.000Z"><meta property="article:modified_time" content="2025-10-25T08:18:29.448Z"><meta property="article:author" content="è¿æ€é‘«"><meta property="article:tag" content="FreeRTOS"><meta property="article:tag" content="STM32"><meta property="article:tag" content="ç¯å¢ƒæ­å»º"><meta property="article:tag" content="CubeMX"><meta property="article:tag" content="Keil"><meta property="article:tag" content="HAL"><meta property="article:tag" content="ST-Link"><meta name="twitter:card" content="summary_large_image"><meta name="referrer" content="no-referrer-when-downgrade"><title>ã€ŠFreeRTOS å…¨æ ˆå·¥ç¨‹å®æˆ˜æ•™ç¨‹ã€‹ç¬¬2.1ç¯‡ï¼šSTM32 ç¯å¢ƒæ­å»º (CubeMX + Keil) ä¸å·¥ç¨‹çƒ§å½•å…¨æµç¨‹ - è¿æ€é‘«çš„åšå®¢</title><link rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css"><link rel="stylesheet" href="/css/main.css"><link id="highlight-css" rel="stylesheet" href="/css/highlight.css"><link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css"><script id="fluid-configs">var Fluid=window.Fluid||{};Fluid.ctx=Object.assign({},Fluid.ctx);var dntVal,CONFIG={hostname:"jinbilianshao.github.io",root:"/",version:"1.9.1",typing:{enable:!0,typeSpeed:70,cursorChar:"_",loop:!1,scope:[]},anchorjs:{enable:!0,element:"h1,h2,h3,h4,h5,h6",placement:"left",visible:"hover",icon:""},progressbar:{enable:!0,height_px:3,color:"#29d",options:{showSpinner:!1,trickleSpeed:100}},code_language:{enable:!0,default:"TEXT"},copy_btn:!0,image_caption:{enable:!0},image_zoom:{enable:!0,img_url_replace:["",""]},toc:{enable:!0,placement:"right",headingSelector:"h1,h2,h3,h4,h5,h6",collapseDepth:0},lazyload:{enable:!0,loading_img:"/img/loading.gif",onlypost:!1,offset_factor:2},web_analytics:{enable:!0,follow_dnt:!0,baidu:null,google:null,gtag:null,tencent:{sid:null,cid:null},woyaola:null,cnzz:null,leancloud:{app_id:null,app_key:null,server_url:null,path:"window.location.pathname",ignore_local:!1}},search_path:"/local-search.xml"};CONFIG.web_analytics.follow_dnt&&(dntVal=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,Fluid.ctx.dnt=dntVal&&(dntVal.startsWith("1")||dntVal.startsWith("yes")||dntVal.startsWith("on")))</script><script src="/js/utils.js"></script><script src="/js/color-schema.js"></script><meta name="generator" content="Hexo 7.3.0"></head><body><header><div class="header-inner" style="height:70vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/"><strong>è¿æ€é‘«çš„åšå®¢</strong> </a><button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="https://jinbilianshao.github.io"><i class="iconfont icon-home-fill"></i> é¦–é¡µ</a></li><li class="nav-item"><a class="nav-link" href="/archives/"><i class="iconfont icon-archive-fill"></i> å½’æ¡£</a></li><li class="nav-item"><a class="nav-link" href="/categories/"><i class="iconfont icon-category-fill"></i> åˆ†ç±»</a></li><li class="nav-item"><a class="nav-link" href="/tags/"><i class="iconfont icon-tags-fill"></i> æ ‡ç­¾</a></li><li class="nav-item"><a class="nav-link" href="https://jinbilianshao.github.io/xiaoxin/"><i class="iconfont icon-user-fill"></i> å…³äº</a></li><li class="nav-item" id="search-btn"><a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">&nbsp;<i class="iconfont icon-search"></i>&nbsp;</a></li><li class="nav-item" id="color-toggle-btn"><a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a></li></ul></div></div></nav><div id="banner" class="banner" parallax="true" style="background:url(/img/default.png) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask flex-center" style="background-color:rgba(0,0,0,.3)"><div class="banner-text text-center fade-in-up"><div class="h2"><span id="subtitle" data-typed-text="ã€ŠFreeRTOS å…¨æ ˆå·¥ç¨‹å®æˆ˜æ•™ç¨‹ã€‹ç¬¬2.1ç¯‡ï¼šSTM32 ç¯å¢ƒæ­å»º (CubeMX + Keil) ä¸å·¥ç¨‹çƒ§å½•å…¨æµç¨‹"></span></div><div class="mt-3"><span class="post-meta mr-2"><i class="iconfont icon-author" aria-hidden="true"></i> è¿æ€é‘« </span><span class="post-meta"><i class="iconfont icon-date-fill" aria-hidden="true"></i> <time datetime="2025-10-25 16:17" pubdate>2025å¹´10æœˆ25æ—¥ ä¸‹åˆ</time></span></div><div class="mt-1"><span class="post-meta mr-2"><i class="iconfont icon-chart"></i>7.3k å­— </span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i> 62 åˆ†é’Ÿ </span><span id="busuanzi_container_page_pv" style="display:none"><i class="iconfont icon-eye" aria-hidden="true"></i> <span id="busuanzi_value_page_pv"></span> æ¬¡</span></div></div></div></div></div></div></header><main><div class="container-fluid nopadding-x"><div class="row nomargin-x"><div class="side-col d-none d-lg-block col-lg-2"></div><div class="col-lg-8 nopadding-x-md"><div class="container nopadding-x-md" id="board-ctn"><div id="board"><article class="post-content mx-auto"><h1 style="display:none">ã€ŠFreeRTOS å…¨æ ˆå·¥ç¨‹å®æˆ˜æ•™ç¨‹ã€‹ç¬¬2.1ç¯‡ï¼šSTM32 ç¯å¢ƒæ­å»º (CubeMX + Keil) ä¸å·¥ç¨‹çƒ§å½•å…¨æµç¨‹</h1><p class="note note-info">æœ¬æ–‡æœ€åæ›´æ–°äºï¼š2025å¹´10æœˆ25æ—¥ ä¸‹åˆ</p><div class="markdown-body"><h1>ã€ŠFreeRTOS å…¨æ ˆå·¥ç¨‹å®æˆ˜æ•™ç¨‹ã€‹ç¬¬2.1ç¯‡ï¼šSTM32 ç¯å¢ƒæ­å»º (CubeMX + Keil) ä¸å·¥ç¨‹çƒ§å½•å…¨æµç¨‹</h1><p>â­ <strong>éš¾åº¦ç­‰çº§ï¼šâ˜…â˜†â˜† åŸºç¡€</strong></p><p><strong>æ ‡ç­¾</strong>ï¼š<code>FreeRTOS</code>, <code>STM32</code>, <code>CubeMX</code>, <code>Keil</code>, <code>HAL</code>, <code>ç¯å¢ƒæ­å»º</code>, <code>ST-Link</code></p><h2 id="ğŸ“-å®æˆ˜é—®é¢˜åœºæ™¯">ğŸ“ å®æˆ˜é—®é¢˜åœºæ™¯</h2><p>åœ¨ç¬¬0ç¯‡ä¸­ï¼Œæˆ‘ä»¬å‡†å¤‡å¥½äº†æ‰€æœ‰çš„â€œåŸææ–™â€ï¼ˆç¡¬ä»¶æ¿å¡ã€è½¯ä»¶å·¥å…·ï¼‰ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬é¢ä¸´ç€ç¬¬ä¸€ä¸ªâ€œå·¥ç¨‹â€é—®é¢˜ï¼š</p><ul><li>â€œæˆ‘å¦‚ä½•å°†è¿™äº›ç‹¬ç«‹çš„å·¥å…·ï¼ˆCubeMX, Keil, ST-Linkï¼‰ç»„åˆèµ·æ¥ï¼Œå½¢æˆä¸€ä¸ªå®Œæ•´çš„å¼€å‘å·¥ä½œæµï¼Ÿâ€</li><li>â€œCubeMX ç”Ÿæˆçš„å‡ ç™¾ä¸ªæ–‡ä»¶ï¼Œåˆ°åº•æ˜¯ä»€ä¹ˆå…³ç³»ï¼Ÿæˆ‘åº”è¯¥åœ¨å“ªé‡Œå†™ä»£ç ï¼Ÿâ€</li><li>â€œä¸ºä»€ä¹ˆæˆ‘ç‚¹å‡»â€˜ä¸‹è½½â€™ï¼ŒKeil æ€»æ˜¯æç¤ºâ€˜No ST-Link detectedâ€™æˆ–â€˜Flash Download failedâ€™ï¼Ÿâ€</li><li>â€œåœ¨ STM32 ä¸Šå¯ç”¨ FreeRTOSï¼Œæœ€å…³é”®çš„æ­¥éª¤æ˜¯ä»€ä¹ˆï¼Ÿâ€</li></ul><p>æœ¬ç¯‡å°†æ‰‹æŠŠæ‰‹å¸¦ä½ <strong>ä» 0 å¼€å§‹</strong>ï¼Œå»ºç«‹ä¸€ä¸ª<strong>æ ‡å‡†ã€å¯å¤ç°ã€ç¨³å®š</strong>çš„ STM32 FreeRTOS é¡¹ç›®æ¨¡æ¿ã€‚æˆ‘ä»¬å°†æ‰“é€šâ€œé…ç½®-ç¼–è¯‘-çƒ§å½•-è¿è¡Œâ€çš„å®Œæ•´é—­ç¯ã€‚è¿™æ˜¯ä½ åç»­æ‰€æœ‰ STM32 å®éªŒçš„åŸºçŸ³ã€‚</p><h2 id="ğŸ¯-æœ¬ç¯‡èƒ½åŠ›ç›®æ ‡">ğŸ¯ æœ¬ç¯‡èƒ½åŠ›ç›®æ ‡</h2><ol><li><p>âœ… <strong>æŒæ¡ CubeMX</strong>ï¼šå­¦ä¼šä½¿ç”¨ CubeMX å®Œæˆ MCU çš„æ ¸å¿ƒé…ç½®ï¼ˆæ—¶é’Ÿã€è°ƒè¯•ã€GPIOï¼‰ã€‚</p></li><li><p>âœ… <strong>æ‰“é€šå·¥å…·é“¾</strong>ï¼šè·‘é€šä¸€ä¸ª<strong>è£¸æœº (Bare-Metal) LED é—ªçƒç¨‹åº</strong>ï¼ŒéªŒè¯ CubeMX â†’ Keil â†’ ST-Link â†’ ç¡¬ä»¶çš„å…¨é“¾è·¯ã€‚</p></li><li><p>âœ… é›†æˆ RTOSï¼šå­¦ä¼š</p><p>åœ¨ CubeMX ä¸­æ­£ç¡®å¯ç”¨ FreeRTOS (CMSIS-RTOS V1)ã€‚</p></li><li><p>âœ… <strong>è§£å†³å…³é”®å†²çª</strong>ï¼šç†è§£å¹¶è§£å†³ FreeRTOS ä¸ HAL åº“ä¹‹é—´æœ€è‘—åçš„ <strong>SysTick æ—¶é’ŸåŸºå‡†å†²çª</strong>ã€‚</p></li><li><p>âœ… <strong>æœ€ç»ˆæˆæœ</strong>ï¼šæˆåŠŸç¼–è¯‘ä¸€ä¸ª<strong>å·²åŒ…å« FreeRTOS å†…æ ¸</strong>çš„å·¥ç¨‹ï¼Œå¹¶å¯åŠ¨è°ƒåº¦å™¨ï¼Œä¸ºç¬¬3ç¯‡æ·»åŠ ä»»åŠ¡åšå¥½ä¸‡å…¨å‡†å¤‡ã€‚</p></li></ol><h2 id="ğŸ§ -ç†è®ºç®€æï¼šSTM32-å¼€å‘â€œä¸‰å‰‘å®¢â€">ğŸ§  ç†è®ºç®€æï¼šSTM32 å¼€å‘â€œä¸‰å‰‘å®¢â€</h2><p>å¯¹äºåˆå­¦è€…ï¼Œç†è§£ CubeMX, Keil, HAL åº“ä¸‰è€…çš„å…³ç³»è‡³å…³é‡è¦ï¼š</p><ol><li><strong>STM32CubeMX (é…ç½®å™¨ &amp; ä»£ç ç”Ÿæˆå™¨)</strong><ul><li><strong>ä½œç”¨</strong>ï¼šä¸€ä¸ªå›¾å½¢åŒ–å·¥å…·ï¼Œå¸®ä½ â€œç‚¹èœâ€ã€‚</li><li><strong>ä½ åšä»€ä¹ˆ</strong>ï¼šåœ¨å›¾å½¢ç•Œé¢ä¸Šç‚¹å‡»ï¼Œé€‰æ‹©ä½ è¦å¯ç”¨å“ªä¸ªå¤–è®¾ï¼ˆå¦‚ GPIOã€UARTï¼‰ã€é…ç½®æ—¶é’Ÿæ ‘ã€é€‰æ‹©ä¸­é—´ä»¶ï¼ˆå¦‚ FreeRTOSï¼‰ã€‚</li><li><strong>å®ƒåšä»€ä¹ˆ</strong>ï¼šä¸ºä½ ç”Ÿæˆæ‰€æœ‰ç¹ççš„<strong>åˆå§‹åŒ– C ä»£ç </strong>ï¼ˆå¦‚ <code>MX_GPIO_Init()</code>ï¼‰å’Œ Keil MDK å·¥ç¨‹æ–‡ä»¶ã€‚</li></ul></li><li><strong>Keil MDK (IDE / ç¼–è¯‘å™¨ / è°ƒè¯•å™¨)</strong><ul><li><strong>ä½œç”¨</strong>ï¼šâ€œå¨æˆ¿å’Œå¨å¸ˆâ€ã€‚</li><li><strong>ä½ åšä»€ä¹ˆ</strong>ï¼šåœ¨ Keil ä¸­ç¼–å†™<strong>æ ¸å¿ƒåº”ç”¨é€»è¾‘</strong>ï¼ˆä¾‹å¦‚ <code>while(1)</code> é‡Œçš„é—ªç¯ä»£ç ï¼Œæˆ– FreeRTOS çš„ä»»åŠ¡å‡½æ•°ï¼‰ã€‚</li><li><strong>å®ƒåšä»€ä¹ˆ</strong>ï¼šç¼–è¯‘ä½ çš„ä»£ç å’Œ CubeMX ç”Ÿæˆçš„ä»£ç ï¼Œå°†å®ƒä»¬é“¾æ¥æˆä¸€ä¸ª <code>.hex</code> æˆ– <code>.axf</code> æ–‡ä»¶ï¼Œå¹¶é€šè¿‡ ST-Link çƒ§å½•åˆ°èŠ¯ç‰‡ä¸­ï¼Œå¹¶æä¾›è°ƒè¯•åŠŸèƒ½ã€‚</li></ul></li><li><strong>HAL åº“ (ç¡¬ä»¶æŠ½è±¡å±‚)</strong><ul><li><strong>ä½œç”¨</strong>ï¼šâ€œæ ‡å‡†èœè°±â€ã€‚</li><li><strong>å®ƒæ˜¯ä»€ä¹ˆ</strong>ï¼šST å®˜æ–¹æä¾›çš„é©±åŠ¨åº“ã€‚CubeMX ç”Ÿæˆçš„ä»£ç <strong>ä¾èµ–</strong>äºå®ƒã€‚</li><li><strong>å®ƒåšä»€ä¹ˆ</strong>ï¼šå®ƒæä¾›äº†ç»Ÿä¸€çš„ APIï¼Œè®©ä½ æ‘†è„±ç¹ççš„å¯„å­˜å™¨æ“ä½œã€‚<ul><li>è£¸æœºå¯„å­˜å™¨æ“ä½œï¼š<code>GPIOA-&gt;BSRR = (1 &lt;&lt; 5);</code> (æ™¦æ¶©éš¾æ‡‚)</li><li>HAL åº“æ“ä½œï¼š<code>HAL_GPIO_WritePin(GPIOA, GPIO_PIN_5, GPIO_PIN_SET);</code> (æ¸…æ™°æ˜“æ‡‚)</li></ul></li></ul></li></ol><p>æˆ‘ä»¬çš„å·¥ä½œæµï¼š</p><p>åœ¨ CubeMX ä¸­é…ç½® â†’ ç”Ÿæˆä»£ç  â†’ åœ¨ Keil ä¸­ç¼–å†™ä¸šåŠ¡é€»è¾‘ â†’ åœ¨ Keil ä¸­ç¼–è¯‘å’Œçƒ§å½• â†’ ï¼ˆè°ƒè¯•ï¼‰ â†’ ï¼ˆæœ‰æ–°éœ€æ±‚ï¼Ÿï¼‰ â†’ å›åˆ° CubeMX ä¿®æ”¹é…ç½® â†’ â€¦</p><hr><h2 id="ğŸ› ï¸-å®æ“æ­¥éª¤">ğŸ› ï¸ å®æ“æ­¥éª¤</h2><p>æœ¬æ•™ç¨‹ä»¥ç¬¬0ç¯‡æ¨èçš„ <strong>STM32F407VET6 (å°é»‘æ¿)</strong> å’Œ <strong>ST-Link V2</strong> ä¸ºä¾‹ã€‚</p><h3 id="ç¬¬1éƒ¨åˆ†ï¼šè£¸æœº-LED-é—ªçƒ-éªŒè¯å·¥å…·é“¾">ç¬¬1éƒ¨åˆ†ï¼šè£¸æœº LED é—ªçƒ (éªŒè¯å·¥å…·é“¾)</h3><p>åœ¨é›†æˆ RTOS ä¹‹å‰ï¼Œæˆ‘ä»¬å¿…é¡»å…ˆä¿è¯è£¸æœºèƒ½è·‘é€šã€‚</p><h4 id="1-CubeMX-åˆ›å»ºå·¥ç¨‹ä¸é…ç½®">1. CubeMX: åˆ›å»ºå·¥ç¨‹ä¸é…ç½®</h4><ol><li>æ‰“å¼€ <code>STM32CubeMX</code>ã€‚</li><li>ç‚¹å‡» <code>File</code> â†’ <code>New Project</code> (æˆ– <code>ACCESS TO MCU SELECTOR</code>)ã€‚</li><li>åœ¨ <code>MCU/MPU Selector</code> æœç´¢æ¡†ä¸­è¾“å…¥ <code>STM32F407VET6</code>ã€‚</li><li>åœ¨ä¸‹æ–¹åˆ—è¡¨ä¸­é€‰ä¸­å®ƒï¼Œç‚¹å‡» <code>Start Project</code>ã€‚</li><li><strong>[å…³é”®] é…ç½®è°ƒè¯•æ¥å£</strong>ï¼š<ul><li>åœ¨å·¦ä¾§ <code>System Core</code> ä¸­é€‰æ‹© <code>SYS</code>ã€‚</li><li>åœ¨ <code>Debug</code> ä¸‹æ‹‰æ¡†ä¸­ï¼Œé€‰æ‹© <code>Serial Wire</code>ã€‚</li><li><em>(è¿™æ˜¯æ–°æ‰‹æœ€å®¹æ˜“å¿˜çš„ä¸€æ­¥ï¼å¦‚æœä¸é€‰ï¼ŒèŠ¯ç‰‡çƒ§å½•ä¸€æ¬¡åå¯èƒ½å°±å†ä¹Ÿæ— æ³•è¿æ¥äº†)</em></li></ul></li><li><strong>[å…³é”®] é…ç½®æ—¶é’Ÿæº</strong>ï¼š<ul><li><code>System Core</code> â†’ <code>RCC</code>ã€‚</li><li>åœ¨ <code>High Speed Clock (HSE)</code> ä¸‹æ‹‰æ¡†ä¸­ï¼Œé€‰æ‹© <code>Crystal/Ceramic Resonator</code> (æ™¶ä½“/é™¶ç“·è°æŒ¯å™¨)ã€‚</li></ul></li><li><strong>é…ç½® LED å¯¹åº”çš„ GPIO</strong>ï¼š<ul><li>(F407VET6 å°é»‘æ¿çš„ LED é€šå¸¸åœ¨ <code>PA0</code> æˆ– <code>PA1</code>ï¼Œè¯·æ ¹æ®ä½ çš„æ¿å­ç¡®è®¤)ã€‚</li><li>å‡è®¾ä¸º <code>PA0</code>ã€‚åœ¨å³ä¾§èŠ¯ç‰‡å¼•è„šå›¾ä¸Šæ‰¾åˆ° <code>PA0</code>ï¼Œå•å‡»å®ƒï¼Œé€‰æ‹© <code>GPIO_Output</code>ã€‚</li><li><em>(å¯é€‰)</em>ï¼šåœ¨ <code>System Core</code> â†’ <code>GPIO</code> ä¸­é€‰ä¸­ <code>PA0</code>ï¼Œåœ¨ <code>User Label</code> æ è¾“å…¥ <code>LED_D1</code>ï¼Œæ–¹ä¾¿è®°å¿†ã€‚</li></ul></li></ol><h4 id="2-CubeMX-é…ç½®æ—¶é’Ÿæ ‘">2. CubeMX: é…ç½®æ—¶é’Ÿæ ‘</h4><ol><li>åˆ‡æ¢åˆ° <code>Clock Configuration</code> æ ‡ç­¾é¡µã€‚</li><li><code>Input frequency (HSE)</code> å¤„åº”ä¸º <code>8</code> MHz (F407 å°é»‘æ¿é€šå¸¸å¤–æ¥ 8MHz æ™¶æŒ¯)ã€‚</li><li><code>PLL Source Mux</code> é€‰æ‹© <code>HSE</code>ã€‚</li><li>åœ¨ <code>HCLK (MHz)</code> è¾“å…¥æ¡†ä¸­ï¼Œç›´æ¥è¾“å…¥ <code>168</code> (F407 çš„æœ€é«˜ä¸»é¢‘)ï¼Œç„¶åæŒ‰å›è½¦ã€‚</li><li>CubeMX ä¼šè‡ªåŠ¨è§£ç®—å‡ºæ‰€æœ‰ PLL åˆ†é¢‘ç³»æ•°ã€‚å¼¹çª—æç¤ºæ—¶ï¼Œç‚¹å‡» <code>OK</code>ã€‚æ—¶é’Ÿæ ‘ä¼šè‡ªåŠ¨å˜è“ã€‚</li></ol><h4 id="3-CubeMX-ç”Ÿæˆ-Keil-å·¥ç¨‹">3. CubeMX: ç”Ÿæˆ Keil å·¥ç¨‹</h4><ol><li>åˆ‡æ¢åˆ° <code>Project Manager</code> æ ‡ç­¾é¡µã€‚</li><li><code>Project Name</code>: <code>STM32_P2_BareMetal_Blink</code></li><li><code>Project Location</code>: é€‰æ‹©ä½ ä»£ç ä»“ä¸­çš„ <code>stm32/</code> ç›®å½•ã€‚</li><li><code>Toolchain / IDE</code>: é€‰æ‹© <code>MDK-ARM V5</code>ã€‚</li><li>ç‚¹å‡»å³ä¸Šè§’çš„ <code>GENERATE CODE</code>ã€‚</li></ol><h4 id="4-Keil-ç¼–å†™ã€ç¼–è¯‘ä¸çƒ§å½•">4. Keil: ç¼–å†™ã€ç¼–è¯‘ä¸çƒ§å½•</h4><ol><li><p>ç”Ÿæˆå®Œæ¯•åï¼Œç‚¹å‡» <code>Open Project</code>ï¼Œè‡ªåŠ¨æ‰“å¼€ Keil MDK5ã€‚</p></li><li><p>åœ¨ Keil å·¦ä¾§ <code>Project</code> çª—å£ï¼Œå±•å¼€ <code>Application/User/Core</code>ï¼ŒåŒå‡»æ‰“å¼€ <code>main.c</code>ã€‚</p></li><li><p>æ‰¾åˆ° <code>/* USER CODE BEGIN WHILE */</code> å’Œ <code>/* USER CODE END WHILE */</code> ä¹‹é—´çš„ <code>while(1)</code> å¾ªç¯ã€‚</p></li><li><p>æ·»åŠ æˆ‘ä»¬çš„é—ªç¯ä»£ç  (è¿™æ˜¯<strong>è£¸æœº</strong>ä»£ç )ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">/* USER CODE BEGIN WHILE */</span><br><span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>)<br>&#123;<br>  <span class="hljs-comment">/* USER CODE END WHILE */</span><br><br>  <span class="hljs-comment">/* USER CODE BEGIN 3 */</span><br>  <span class="hljs-comment">// (æ³¨æ„: å¦‚æœä½ çš„ Label å« LED_D1)</span><br>  HAL_GPIO_TogglePin(LED_D1_GPIO_Port, LED_D1_Pin);<br>  <span class="hljs-comment">// (å¦‚æœæ²¡è®¾ç½® Labelï¼Œé»˜è®¤ä¸º PA0)</span><br>  <span class="hljs-comment">// HAL_GPIO_TogglePin(GPIOA, GPIO_PIN_0); </span><br><br>  <span class="hljs-comment">// è£¸æœºé˜»å¡å¼å»¶æ—¶</span><br>  HAL_Delay(<span class="hljs-number">500</span>); <span class="hljs-comment">// å»¶æ—¶ 500ms</span><br>&#125;<br><span class="hljs-comment">/* USER CODE END 3 */</span><br></code></pre></td></tr></table></figure></li><li><p><strong>[å…³é”®] é…ç½® ST-Link è°ƒè¯•å™¨</strong>ï¼š</p><ul><li>ç‚¹å‡»èœå•æ çš„ <code>Options for Target...</code> (é­”æœ¯æ£’å›¾æ ‡ ğŸª„)ã€‚</li><li>åˆ‡æ¢åˆ° <code>Debug</code> æ ‡ç­¾é¡µã€‚</li><li>åœ¨å³ä¸Šæ–¹çš„ä¸‹æ‹‰æ¡†ä¸­ï¼Œé€‰æ‹© <code>ST-Link Debugger</code>ã€‚</li><li>ç‚¹å‡»æ—è¾¹çš„ <code>Settings</code> æŒ‰é’®ã€‚</li><li>åœ¨ <code>Port:</code> ä¸‹æ‹‰æ¡†ä¸­é€‰æ‹© <code>SW</code> (Serial Wire)ã€‚</li><li>åˆ‡æ¢åˆ° <code>Flash Download</code> æ ‡ç­¾é¡µã€‚</li><li>å‹¾é€‰ <code>Reset and Run</code> (ç¡®ä¿çƒ§å½•åèŠ¯ç‰‡è‡ªåŠ¨é‡å¯è¿è¡Œ)ã€‚</li><li>ç‚¹å‡» <code>OK</code> ä¿å­˜è®¾ç½®ã€‚</li></ul></li><li><p><strong>ç¼–è¯‘å’Œçƒ§å½•</strong>ï¼š</p><ul><li>æ’ä¸Šä½ çš„ ST-Link å’Œ STM32 å¼€å‘æ¿ã€‚</li><li>ç‚¹å‡» <code>Build</code> (F7 æˆ–å·¥å…·æ çš„ ğŸ—ï¸ å›¾æ ‡)ã€‚ç­‰å¾…ç¼–è¯‘â€¦ çœ‹åˆ° <code>0 Error(s), 0 Warning(s)</code>ã€‚</li><li>ç‚¹å‡» <code>Download</code> (F8 æˆ–å·¥å…·æ çš„ ğŸ“¥ å›¾æ ‡)ã€‚</li><li>Keil çš„ <code>Build Output</code> çª—å£æç¤º <code>Download... Done.</code></li></ul></li><li><p><strong>éªŒè¯</strong>ï¼šæŸ¥çœ‹ä½ çš„å¼€å‘æ¿ï¼Œ<strong>LED æ­£åœ¨ä»¥ 1 ç§’ 1 æ¬¡çš„é¢‘ç‡é—ªçƒï¼</strong> æ­å–œï¼Œä½ å·²æ‰“é€šè£¸æœºå¼€å‘å…¨é“¾è·¯ï¼</p></li></ol><hr><h3 id="ç¬¬2éƒ¨åˆ†ï¼šé›†æˆ-FreeRTOS-å‡†å¤‡-RTOS-ç¯å¢ƒ">ç¬¬2éƒ¨åˆ†ï¼šé›†æˆ FreeRTOS (å‡†å¤‡ RTOS ç¯å¢ƒ)</h3><p>ç°åœ¨ï¼Œæˆ‘ä»¬åœ¨ä¸Šä¸€æ­¥çš„åŸºç¡€ä¸Šï¼Œå¼•å…¥ FreeRTOSã€‚</p><h4 id="1-CubeMX-å¯ç”¨-FreeRTOS">1. CubeMX: å¯ç”¨ FreeRTOS</h4><ol><li><p>å›åˆ° CubeMXï¼Œæ‰“å¼€åˆšæ‰çš„ <code>.ioc</code> å·¥ç¨‹æ–‡ä»¶ã€‚</p></li><li><p>åœ¨å·¦ä¾§ <code>Middleware</code> ä¸­ï¼Œç‚¹å‡» <code>FREERTOS</code>ã€‚</p></li><li><p>åœ¨ Interface ä¸‹æ‹‰æ¡†ä¸­ï¼Œé€‰æ‹© CMSIS_V1ã€‚</p><p>(æ³¨ï¼šCMSIS-RTOS V1 æ˜¯ Keil MDK5 é…åˆ HAL åº“æœ€ç»å…¸ã€å…¼å®¹æ€§æœ€å¥½çš„ FreeRTOS å°è£…å±‚)</p></li><li><p>(å¯é€‰) <code>Config parameters</code> ä¸­å¯ä»¥é…ç½®å †æ ˆå¤§å°ã€æ—¶é’Ÿé¢‘ç‡ç­‰ï¼Œæš‚æ—¶ä¿æŒé»˜è®¤ï¼ˆ<code>TICK_RATE_HZ</code> ä¸º 1000ï¼‰ã€‚</p></li></ol><h4 id="2-CubeMX-æœ€å…³é”®-è§£å†³-SysTick-å†²çª">2. CubeMX: [æœ€å…³é”®] è§£å†³ SysTick å†²çª</h4><ol><li><strong>é—®é¢˜</strong>ï¼š<ul><li>è£¸æœºä¸­ï¼Œ<code>HAL_Delay()</code> é»˜è®¤ä½¿ç”¨ <code>SysTick</code> å®šæ—¶å™¨ã€‚</li><li>FreeRTOS å¯åŠ¨åï¼Œä¹Ÿ<strong>éœ€è¦</strong> <code>SysTick</code> å®šæ—¶å™¨æ¥äº§ç”Ÿ<strong>ç³»ç»Ÿæ—¶é’ŸèŠ‚æ‹ (Tick)</strong>ï¼Œç”¨äºä»»åŠ¡è°ƒåº¦å’Œ <code>vTaskDelay()</code>ã€‚</li><li>ä¸¤è€…<strong>å†²çª</strong>ï¼SysTick åªèƒ½è¢«ä¸€ä¸ªç»„ä»¶ä¸»å¯¼ã€‚</li></ul></li><li><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šå°† HAL åº“çš„ <code>Timebase Source</code> (æ—¶åŸºæº) ä» <code>SysTick</code> æ”¹ä¸ºå¦ä¸€ä¸ª<strong>é€šç”¨å®šæ—¶å™¨</strong> (å¦‚ <code>TIM6</code>, <code>TIM7</code>â€¦)ã€‚</li><li><strong>æ“ä½œ</strong>ï¼š<ul><li>åœ¨ <code>System Core</code> ä¸­é€‰æ‹© <code>SYS</code>ã€‚</li><li>åœ¨ <code>Timebase Source</code> ä¸‹æ‹‰æ¡†ä¸­ï¼Œé€‰æ‹©ä¸€ä¸ª<strong>ä¸å†²çª</strong>çš„å®šæ—¶å™¨ï¼Œä¾‹å¦‚ <code>TIM6</code>ã€‚</li><li>(CubeMX å¯èƒ½ä¼šè‡ªåŠ¨å¼¹å‡ºè­¦å‘Šæç¤ºä½ ä¿®æ”¹ï¼Œé€‰æ‹© <code>TIM6</code> å³å¯)</li></ul></li></ol><h4 id="3-CubeMX-é‡æ–°ç”Ÿæˆä»£ç ">3. CubeMX: é‡æ–°ç”Ÿæˆä»£ç </h4><ol><li>å›åˆ° <code>Project Manager</code> æ ‡ç­¾é¡µã€‚</li><li>å†æ¬¡ç‚¹å‡» <code>GENERATE CODE</code>ã€‚</li><li>Keil MDK ä¼šæç¤º <code>File '...' has been modified outside the editor.</code>ï¼Œé€‰æ‹© <code>Reload All</code> (å…¨éƒ¨é‡æ–°åŠ è½½)ã€‚</li></ol><h4 id="4-Keil-éªŒè¯-RTOS-ç¯å¢ƒ">4. Keil: éªŒè¯ RTOS ç¯å¢ƒ</h4><ol><li><strong>æ¸…ç†è£¸æœºä»£ç </strong>ï¼šå›åˆ° <code>main.c</code>ï¼Œ<strong>åˆ é™¤</strong>ä½ åœ¨ <code>while(1)</code> ä¸­æ·»åŠ çš„ <code>HAL_GPIO_TogglePin</code> å’Œ <code>HAL_Delay</code> ä»£ç ã€‚è®© <code>while(1)</code> ä¿æŒ<strong>ç©ºç½®</strong>ã€‚</li><li><strong>æ£€æŸ¥ RTOS å¯åŠ¨</strong>ï¼š<ul><li>æŸ¥çœ‹ <code>main()</code> å‡½æ•°ï¼Œä½ ä¼šå‘ç° CubeMX è‡ªåŠ¨æ·»åŠ äº† <code>MX_FREERTOS_Init();</code>ã€‚</li><li>åœ¨ <code>main.c</code> çš„æœ€åï¼Œ<code>vTaskStartScheduler();</code> å‡½æ•°è¢«è°ƒç”¨äº†ï¼ˆå®ƒå¯èƒ½åœ¨ <code>main</code> ä¸­ï¼Œä¹Ÿå¯èƒ½åœ¨ <code>freertos.c</code> çš„ <code>MX_FREERTOS_Init</code> ä¸­è¢«è°ƒç”¨ï¼Œå–å†³äº CubeMX ç‰ˆæœ¬ï¼‰ã€‚</li><li><strong><code>vTaskStartScheduler();</code> æ˜¯ RTOS å¯åŠ¨çš„æ ‡å¿—ã€‚</strong> ä¸€æ—¦å®ƒè¿è¡Œï¼Œè°ƒåº¦å™¨å°†æ¥ç®¡ CPUï¼Œ<code>main()</code> å‡½æ•°ä¸­çš„ <code>while(1)</code> å¾ªç¯å°†<strong>æ°¸è¿œä¸ä¼šè¢«æ‰§è¡Œ</strong>ã€‚</li></ul></li><li><strong>ç¼–è¯‘å’Œçƒ§å½•</strong>ï¼š<ul><li>ç‚¹å‡» <code>Build</code> (F7)ã€‚</li><li>ç‚¹å‡» <code>Download</code> (F8)ã€‚</li></ul></li><li><strong>éªŒè¯</strong>ï¼š<ul><li>æŸ¥çœ‹ä½ çš„å¼€å‘æ¿ï¼Œ<strong>LED åœæ­¢é—ªçƒäº†ï¼ˆä¿æŒç†„ç­æˆ–é•¿äº®ï¼‰</strong>ã€‚</li><li><strong>è¿™æ˜¯æ­£ç¡®çš„ï¼</strong> ä¸ºä»€ä¹ˆï¼Ÿå› ä¸ºæˆ‘ä»¬å¯åŠ¨äº† FreeRTOS è°ƒåº¦å™¨ï¼Œä½†æˆ‘ä»¬<strong>æ²¡æœ‰åˆ›å»ºä»»ä½•ä»»åŠ¡</strong> (Task) å»é—ªçƒ LEDã€‚CPU æ­¤æ—¶æ­£åœ¨ç©ºé—²ä»»åŠ¡ (<code>vTaskIdle</code>) å’Œå®šæ—¶å™¨ä»»åŠ¡ä¸­å¾ªç¯ï¼Œè€Œæˆ‘ä»¬ä¹‹å‰åœ¨ <code>while(1)</code> å†™çš„è£¸æœºä»£ç å·²ç»è¢« RTOS ç»•è¿‡ã€‚</li></ul></li></ol><h2 id="âœ…-å…¨éƒ¨ä»£ç ">âœ… å…¨éƒ¨ä»£ç </h2><p>æœ¬ç¯‡çš„æ ¸å¿ƒæˆæœæ˜¯å·¥ç¨‹é…ç½®ï¼Œè€Œéå…·ä½“ä»£ç ã€‚ä½†æˆ‘ä»¬æä¾›äº†å…³é”®çš„ <code>main.c</code> ä»£ç ç‰‡æ®µã€‚</p><h4 id="ä»£ç -1-è£¸æœºé—ªç¯-Part-1-æœ€ç»ˆ-main-c-çš„-while-1">ä»£ç  1: è£¸æœºé—ªç¯ (Part 1 æœ€ç»ˆ <code>main.c</code> çš„ <code>while(1)</code>)</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">/* stm32/STM32_P2_BareMetal_Blink/Core/Src/main.c */</span><br><br><span class="hljs-comment">/* USER CODE BEGIN WHILE */</span><br><span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>)<br>&#123;<br>  <span class="hljs-comment">/* USER CODE END WHILE */</span><br><br>  <span class="hljs-comment">/* USER CODE BEGIN 3 */</span><br>  <br>  <span class="hljs-comment">// éªŒè¯å·¥å…·é“¾çš„è£¸æœºé—ªç¯ä»£ç </span><br>  HAL_GPIO_TogglePin(LED_D1_GPIO_Port, LED_D1_Pin);<br>  <br>  <span class="hljs-comment">// è£¸æœºé˜»å¡å¼å»¶æ—¶</span><br>  HAL_Delay(<span class="hljs-number">500</span>); <br>&#125;<br><span class="hljs-comment">/* USER CODE END 3 */</span><br></code></pre></td></tr></table></figure><h4 id="ä»£ç -2-å¯ç”¨-RTOS-å-Part-2-æœ€ç»ˆ-main-c-çš„-main">ä»£ç  2: å¯ç”¨ RTOS å (Part 2 æœ€ç»ˆ <code>main.c</code> çš„ <code>main()</code>)</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">/* stm32/STM32_P2_RTOS_Ready/Core/Src/main.c */</span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span><br>&#123;<br>  <span class="hljs-comment">/* ... (HAL_Init, SystemClock_Config, MX_GPIO_Init, MX_TIM6_Init) ... */</span><br>  <br>  <span class="hljs-comment">/* [å…³é”®] CubeMX è‡ªåŠ¨æ·»åŠ äº† RTOS åˆå§‹åŒ– */</span><br>  MX_FREERTOS_Init();<br><br>  <span class="hljs-comment">/* [å…³é”®] å¯åŠ¨ FreeRTOS è°ƒåº¦å™¨. */</span><br>  <span class="hljs-comment">/* Code below this line will NOT be executed unless scheduler fails to start */</span><br>  vTaskStartScheduler();<br><br>  <span class="hljs-comment">/* We should never get here as control is now taken by the scheduler */</span><br>  <span class="hljs-comment">/* Infinite loop */</span><br>  <span class="hljs-comment">/* USER CODE BEGIN WHILE */</span><br>  <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>)<br>  &#123;<br>    <span class="hljs-comment">/* USER CODE END WHILE */</span><br>    <span class="hljs-comment">/* [æ³¨æ„] è¿™é‡Œçš„ä»£ç æ°¸è¿œä¸ä¼šè¢«æ‰§è¡Œï¼ */</span><br>    <span class="hljs-comment">/* USER CODE BEGIN 3 */</span><br>  &#125;<br>  <span class="hljs-comment">/* USER CODE END 3 */</span><br>&#125;<br></code></pre></td></tr></table></figure><h2 id="ğŸ”-è°ƒè¯•æŠ€å·§ï¼šKeil-è°ƒè¯•å™¨å…¥é—¨">ğŸ” è°ƒè¯•æŠ€å·§ï¼šKeil è°ƒè¯•å™¨å…¥é—¨</h2><ol><li><strong>Error: Flash Download failed</strong>ï¼šè¿™æ˜¯åˆå­¦è€…é‡åˆ°<strong>ç¬¬ä¸€é«˜é¢‘</strong>çš„é”™è¯¯ã€‚è¯·çœ‹ä¸‹ä¸€èŠ‚ã€‚</li><li><strong>å¦‚ä½•è¿›å…¥è°ƒè¯•ï¼Ÿ</strong><ul><li>åœ¨çƒ§å½• (F8) æˆåŠŸåï¼Œç‚¹å‡» <code>Start/Stop Debug Session</code> (Ctrl+F5 æˆ–å·¥å…·æ çš„ ğŸ¯ å›¾æ ‡)ã€‚</li><li>Keil ä¼šåˆ‡æ¢åˆ°è°ƒè¯•ç•Œé¢ã€‚ç‚¹å‡» <code>Run</code> (F5) å…¨é€Ÿè¿è¡Œã€‚</li><li>ç‚¹å‡» <code>Stop</code> (çº¢è‰² X) åœæ­¢è¿è¡Œå¹¶é€€å‡ºè°ƒè¯•ã€‚</li></ul></li><li><strong>System Viewer (ç³»ç»ŸæŸ¥çœ‹å™¨)</strong>ï¼š<ul><li>åœ¨è°ƒè¯•ä¼šè¯ä¸­ (Ctrl+F5)ï¼Œç‚¹å‡»èœå• <code>View</code> â†’ <code>System Viewer</code>ã€‚</li><li>åœ¨å¼¹å‡ºçš„çª—å£ä¸­ï¼Œå±•å¼€ <code>GPIO</code> â†’ <code>GPIOA</code>ã€‚</li><li>ä½ å¯ä»¥å®æ—¶çœ‹åˆ° <code>ODR</code> (Output Data Register) å¯„å­˜å™¨çš„å€¼åœ¨ 0 å’Œ 1 ä¹‹é—´å˜åŒ–ï¼ˆå¯¹åº”è£¸æœºé—ªç¯ï¼‰ï¼ŒéªŒè¯ç¨‹åºæ˜¯å¦åœ¨è·‘ï¼Œå³ä½¿ä½ çš„ LED ç¡¬ä»¶æ¥é”™äº†ã€‚</li></ul></li></ol><h2 id="âš ï¸-å¸¸è§é”™è¯¯ä¸ä¿®å¤">âš ï¸ å¸¸è§é”™è¯¯ä¸ä¿®å¤</h2><ol><li><strong>[æœ€å¸¸è§] é”™è¯¯: â€œFlash Download failed - â€˜Cortex-M4â€™â€ æˆ– â€œNo ST-Link detectedâ€</strong><ul><li><strong>åŸå›  1 (é©±åŠ¨)</strong>: ST-Link é©±åŠ¨æœªå®‰è£… (è§ç¬¬0ç¯‡)ã€‚</li><li><strong>åŸå›  2 (Keil é…ç½®)</strong>: Keil çš„ <code>Options for Target -&gt; Debug</code> ä¸­<strong>æœªé€‰æ‹©</strong> <code>ST-Link Debugger</code>ã€‚</li><li><strong>åŸå›  3 (ç¡¬ä»¶è¿æ¥)</strong>: USB çº¿æ¾åŠ¨ï¼›ST-Link ä¸å¼€å‘æ¿çš„ SWD çº¿ (SWCLK, SWDIO, GND) æ¥é”™æˆ–è™šç„Šã€‚</li><li><strong>åŸå›  4 (èŠ¯ç‰‡è¢«é”)</strong>: CubeMX ä¸­ <code>SYS -&gt; Debug</code> <strong>è¯¯é€‰äº† <code>Disable</code></strong>ï¼Œå¯¼è‡´ SWD å¼•è„šè¢«å¤ç”¨ä¸ºæ™®é€š IOã€‚</li><li><strong>ä¿®å¤ 4</strong>: éœ€è¦è¿›å…¥ DFU æˆ– Bootloader æ¨¡å¼ï¼Œé€šè¿‡ â€œST-Link Utilityâ€ æˆ– â€œCubeProgrammerâ€ è½¯ä»¶æ‰§è¡Œâ€œå…¨ç‰‡æ“¦é™¤â€ (Erase Full Chip)ï¼Œæ‰èƒ½è§£é”ã€‚</li></ul></li><li><strong>[æœ€å…³é”®] é”™è¯¯: FreeRTOS å¯åŠ¨åï¼Œ<code>vTaskDelay()</code> å’Œ <code>HAL_Delay()</code> éƒ½ä¸å‡†æˆ–å¡æ­»</strong><ul><li><strong>åŸå› </strong>: SysTick å†²çªã€‚ä½ å¿˜è®°äº†<strong>ç¬¬2éƒ¨åˆ†-æ­¥éª¤2</strong>ï¼Œæ²¡æœ‰å°† HAL Timebase Source æ”¹ä¸º <code>TIM6</code>ã€‚FreeRTOS æŠ¢å äº† SysTickï¼Œå¯¼è‡´ <code>HAL_Delay()</code> æ°¸è¿œç­‰å¾…ä¸€ä¸ªä¸ä¼šåˆ°æ¥çš„ä¸­æ–­ã€‚</li><li><strong>ä¿®å¤</strong>: ä¸¥æ ¼æŒ‰ç…§æ•™ç¨‹ï¼Œå°† <code>SYS -&gt; Timebase Source</code> æ”¹ä¸º <code>TIM6</code> (æˆ–å…¶å®ƒé€šç”¨å®šæ—¶å™¨)ã€‚</li></ul></li><li><strong>é”™è¯¯: Keil ç¼–è¯‘æç¤º <code>Error: L6218E: Undefined symbol ...</code> (ä¾‹å¦‚ <code>HAL_GPIO_TogglePin</code>)</strong><ul><li><strong>åŸå› </strong>: CubeMX ç”Ÿæˆäº†ä»£ç ï¼Œä½†å¯¹åº”çš„ <code>.c</code> æ–‡ä»¶ï¼ˆå¦‚ <code>stm32f4xx_hal_gpio.c</code>ï¼‰æ²¡æœ‰è¢«æ·»åŠ åˆ° Keil å·¥ç¨‹æ ‘ä¸­ã€‚</li><li><strong>ä¿®å¤</strong>: é‡æ–°ç”Ÿæˆä»£ç  (<code>GENERATE CODE</code>)ã€‚å¦‚æœä»ä¸è¡Œï¼Œåœ¨ <code>Project Manager -&gt; Code Generator</code> å‹¾é€‰ <code>Generate peripheral initialization as a pair of '.c/.h' files per peripheral</code>ã€‚</li></ul></li><li><strong>ç°è±¡: è£¸æœºé—ªç¯ï¼ŒLED é—ªçƒé€Ÿåº¦æ˜æ˜¾ä¸å¯¹ (è¿‡å¿«æˆ–è¿‡æ…¢)</strong><ul><li><strong>åŸå› </strong>: <code>Clock Configuration</code> (æ—¶é’Ÿæ ‘) é…ç½®é”™è¯¯ã€‚</li><li><strong>ä¿®å¤</strong>: æ£€æŸ¥ HSE (æ™¶æŒ¯) é¢‘ç‡æ˜¯å¦ä¸ä½ çš„æ¿å­ä¸€è‡´ (é€šå¸¸æ˜¯ 8MHz æˆ– 25MHz)ã€‚æ£€æŸ¥ HCLK æ˜¯å¦ä¸ºä½ è®¾å®šçš„ 168MHzã€‚<code>HAL_Delay()</code> ä¾èµ–äº HCLKã€‚</li></ul></li></ol><h2 id="ğŸ¯-ç»ƒä¹ æŒ‘æˆ˜">ğŸ¯ ç»ƒä¹ æŒ‘æˆ˜</h2><ol><li><strong>[åŸºç¡€] è£¸æœºæ‰“å¡</strong>ï¼š<ul><li>ä¸¥æ ¼æŒ‰ç…§ <strong>Part 1</strong>ï¼Œå®Œæ•´å¤ç°â€œè£¸æœº LED é—ªçƒâ€ç¨‹åºã€‚</li><li>åœ¨è¯„è®ºåŒºæˆ–ç¤¾ç¾¤æ‰“å¡ï¼Œé™„ä¸Šä½ çš„ LED é—ªçƒ GIFã€‚</li></ul></li><li><strong>[è¿›é˜¶] RTOS ç¯å¢ƒå°±ç»ª</strong>ï¼š<ul><li>åœ¨åŸºç¡€ç»ƒä¹ ä¹‹ä¸Šï¼Œä¸¥æ ¼æŒ‰ç…§ <strong>Part 2</strong>ï¼Œé›†æˆ FreeRTOS å¹¶è§£å†³ SysTick å†²çªã€‚</li><li>ä¸‹è½½ç¨‹åºï¼Œç¡®è®¤ LED <strong>åœæ­¢é—ªçƒ</strong> (è¯æ˜è°ƒåº¦å™¨å·²æ¥ç®¡ CPU)ã€‚</li></ul></li><li><strong>[æŒ‘æˆ˜] éªŒè¯æ—¶é’Ÿä¸å»¶æ—¶</strong>ï¼š<ul><li>å›åˆ° <strong>Part 1</strong> çš„è£¸æœºå·¥ç¨‹ã€‚</li><li>åœ¨ CubeMX ä¸­ï¼Œå°† <code>Clock Configuration</code> é‡Œçš„ <code>HCLK (MHz)</code> ä» <code>168</code> ä¿®æ”¹ä¸º <code>84</code>ã€‚</li><li>é‡æ–°ç”Ÿæˆä»£ç ï¼Œä¸‹è½½åˆ°å¼€å‘æ¿ã€‚</li><li><strong>è§‚å¯Ÿ LED é—ªçƒé€Ÿåº¦</strong>ï¼Œå®ƒå˜å¿«äº†è¿˜æ˜¯å˜æ…¢äº†ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ(æç¤º: <code>HAL_Delay()</code> çš„æ—¶åŸºå˜äº†)ã€‚</li></ul></li></ol><h2 id="ğŸ“-é™„å½•ï¼šCubeMX-Keil-HAL-å…³ç³»å›¾">ğŸ“ é™„å½•ï¼šCubeMX, Keil, HAL å…³ç³»å›¾</h2><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs gherkin">[ä½  (å¼€å‘è€…)]<br>    |<span class="hljs-string"></span><br><span class="hljs-string">    </span>|<span class="hljs-string"> 1. &quot;æˆ‘éœ€è¦ GPIO, æ—¶é’Ÿ 168M, FreeRTOS&quot;</span><br><span class="hljs-string">    v</span><br><span class="hljs-string">[STM32CubeMX] --(ç”Ÿæˆ)--&gt; [MDK-ARM Project File (.uvprojx)]</span><br><span class="hljs-string">    </span>|<span class="hljs-string">                     </span>|<br>    |<span class="hljs-string"> (ç”Ÿæˆ)              </span>|<span class="hljs-string">--&gt; [HAL Init Code (mx_gpio.c)]</span><br><span class="hljs-string">    </span>|<span class="hljs-string">                     </span>|<br>    |<span class="hljs-string"> (ç”Ÿæˆ)              </span>|<span class="hljs-string">--&gt; [FreeRTOS Config (freertos.c)]</span><br><span class="hljs-string">    </span>|<span class="hljs-string">                     </span>|<br>    |<span class="hljs-string"> (ç”Ÿæˆ)              </span>|<span class="hljs-string">--&gt; [main.c (åŒ…å« USER CODE å ä½ç¬¦)]</span><br><span class="hljs-string">    </span>|<br>    v<br>[Keil MDK (IDE)] <span class="hljs-variable">&lt;--(æ‰“å¼€ .uvprojx)</span><br><span class="hljs-variable">    |</span><br><span class="hljs-variable">    | 2. &quot;æˆ‘åœ¨ main.c çš„ while(1) ä¸­æ·»åŠ  HAL_GPIO_TogglePin()&quot;</span><br><span class="hljs-variable">    |</span><br><span class="hljs-variable">    | 3. &quot;ç¼–è¯‘ (F7)&quot;</span><br><span class="hljs-variable">    v</span><br><span class="hljs-variable">[ARMCC ç¼–è¯‘å™¨/é“¾æ¥å™¨] --(é“¾æ¥)--&gt;</span> [ä½ çš„ä»£ç ]<br>    |<span class="hljs-string">                          </span>|<br>    |<span class="hljs-string">                          + [HAL åº“é©±åŠ¨ (stm32f4xx_hal.c)]</span><br><span class="hljs-string">    </span>|<span class="hljs-string">                          </span>|<br>    |<span class="hljs-string">                          + [FreeRTOS æºç  (tasks.c, list.c)]</span><br><span class="hljs-string">    v</span><br><span class="hljs-string">[å¯æ‰§è¡Œæ–‡ä»¶ (.axf / .hex)]</span><br><span class="hljs-string">    </span>|<br>    |<span class="hljs-string"> 4. &quot;ä¸‹è½½ (F8)&quot;</span><br><span class="hljs-string">    v</span><br><span class="hljs-string">[ST-Link V2] --(SWD)--&gt; [STM32F407 èŠ¯ç‰‡]</span><br></code></pre></td></tr></table></figure><hr><p>ä¸‹ä¸€ç¯‡é¢„å‘Šï¼š</p><p>ç¯å¢ƒç»ˆäºæ­å¥½äº†ï¼åœ¨ä¸‹ä¸€ç¯‡ã€Šç¬¬2.2ç¯‡ ESP32 ç¯å¢ƒæ­å»ºï¼šESP-IDF + VSCode å®Œæ•´æŒ‡å—ã€‹ä¸­ï¼Œæˆ‘ä»¬å°†è½¬å‘å¦ä¸€ä¸ªå¼ºå¤§çš„ IoT å¹³å°ã€‚å¦‚æœä½ åªå…³å¿ƒ STM32ï¼Œä¹Ÿå¯ä»¥ç›´æ¥è·³åˆ°ã€Šç¬¬3ç¯‡ ç¬¬ä¸€ä¸ª FreeRTOS å·¥ç¨‹ï¼šLED é—ªçƒå¤šä»»åŠ¡ã€‹ã€‚</p></div><hr><div><div class="post-metas my-3"><div class="post-meta mr-3 d-flex align-items-center"><i class="iconfont icon-category"></i> <span class="category-chains"><span class="category-chain"><a href="/categories/FreeRTOS-%E5%85%A8%E6%A0%88%E5%B7%A5%E7%A8%8B%E5%AE%9E%E6%88%98%E6%95%99%E7%A8%8B/" class="category-chain-item">FreeRTOS å…¨æ ˆå·¥ç¨‹å®æˆ˜æ•™ç¨‹</a></span></span></div><div class="post-meta"><i class="iconfont icon-tags"></i> <a href="/tags/FreeRTOS/">#FreeRTOS</a> <a href="/tags/STM32/">#STM32</a> <a href="/tags/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/">#ç¯å¢ƒæ­å»º</a> <a href="/tags/CubeMX/">#CubeMX</a> <a href="/tags/Keil/">#Keil</a> <a href="/tags/HAL/">#HAL</a> <a href="/tags/ST-Link/">#ST-Link</a></div></div><div class="license-box my-3"><div class="license-title"><div>ã€ŠFreeRTOS å…¨æ ˆå·¥ç¨‹å®æˆ˜æ•™ç¨‹ã€‹ç¬¬2.1ç¯‡ï¼šSTM32 ç¯å¢ƒæ­å»º (CubeMX + Keil) ä¸å·¥ç¨‹çƒ§å½•å…¨æµç¨‹</div><div>https://jinbilianshao.github.io/2025/10/25/ã€ŠFreeRTOS-å…¨æ ˆå·¥ç¨‹å®æˆ˜æ•™ç¨‹ã€‹ç¬¬2-1ç¯‡ï¼šSTM32-ç¯å¢ƒæ­å»º-CubeMX-Keil-ä¸å·¥ç¨‹çƒ§å½•å…¨æµç¨‹/</div></div><div class="license-meta"><div class="license-meta-item"><div>ä½œè€…</div><div>è¿æ€é‘«</div></div><div class="license-meta-item license-meta-date"><div>å‘å¸ƒäº</div><div>2025å¹´10æœˆ25æ—¥</div></div><div class="license-meta-item"><div>è®¸å¯åè®®</div><div><a target="_blank" href="https://creativecommons.org/licenses/by/4.0/"><span class="hint--top hint--rounded" aria-label="BY - ç½²å"><i class="iconfont icon-by"></i></span></a></div></div></div><div class="license-icon iconfont"></div></div><div class="post-prevnext my-3"><article class="post-prev col-6"><a href="/2025/10/25/%E3%80%8AFreeRTOS-%E5%85%A8%E6%A0%88%E5%B7%A5%E7%A8%8B%E5%AE%9E%E6%88%98%E6%95%99%E7%A8%8B%E3%80%8B%E7%AC%AC2-2%E7%AF%87%EF%BC%9AESP32-%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA-ESP-IDF-VSCode-%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97/" title="ã€ŠFreeRTOS å…¨æ ˆå·¥ç¨‹å®æˆ˜æ•™ç¨‹ã€‹ç¬¬2.2ç¯‡ï¼šESP32 ç¯å¢ƒæ­å»º (ESP-IDF + VSCode) å®Œæ•´æŒ‡å—"><i class="iconfont icon-arrowleft"></i> <span class="hidden-mobile">ã€ŠFreeRTOS å…¨æ ˆå·¥ç¨‹å®æˆ˜æ•™ç¨‹ã€‹ç¬¬2.2ç¯‡ï¼šESP32 ç¯å¢ƒæ­å»º (ESP-IDF + VSCode) å®Œæ•´æŒ‡å—</span> <span class="visible-mobile">ä¸Šä¸€ç¯‡</span></a></article><article class="post-next col-6"><a href="/2025/10/25/%E3%80%8AFreeRTOS-%E5%85%A8%E6%A0%88%E5%B7%A5%E7%A8%8B%E5%AE%9E%E6%88%98%E6%95%99%E7%A8%8B%E3%80%8B%E7%AC%AC1%E7%AF%87%EF%BC%9A%E4%BB%80%E4%B9%88%E6%98%AF-FreeRTOS%EF%BC%9F%E9%80%82%E7%94%A8%E5%9C%BA%E6%99%AF%E4%B8%8E%E6%9E%B6%E6%9E%84%E6%80%BB%E8%A7%88/" title="ã€ŠFreeRTOS å…¨æ ˆå·¥ç¨‹å®æˆ˜æ•™ç¨‹ã€‹ç¬¬1ç¯‡ï¼šä»€ä¹ˆæ˜¯ FreeRTOSï¼Ÿé€‚ç”¨åœºæ™¯ä¸æ¶æ„æ€»è§ˆ"><span class="hidden-mobile">ã€ŠFreeRTOS å…¨æ ˆå·¥ç¨‹å®æˆ˜æ•™ç¨‹ã€‹ç¬¬1ç¯‡ï¼šä»€ä¹ˆæ˜¯ FreeRTOSï¼Ÿé€‚ç”¨åœºæ™¯ä¸æ¶æ„æ€»è§ˆ</span> <span class="visible-mobile">ä¸‹ä¸€ç¯‡</span> <i class="iconfont icon-arrowright"></i></a></article></div></div><article id="comments" lazyload><div id="SOHUCS" sid="https://jinbilianshao.github.io/2025/10/25/%E3%80%8AFreeRTOS-%E5%85%A8%E6%A0%88%E5%B7%A5%E7%A8%8B%E5%AE%9E%E6%88%98%E6%95%99%E7%A8%8B%E3%80%8B%E7%AC%AC2-1%E7%AF%87%EF%BC%9ASTM32-%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA-CubeMX-Keil-%E4%B8%8E%E5%B7%A5%E7%A8%8B%E7%83%A7%E5%BD%95%E5%85%A8%E6%B5%81%E7%A8%8B/"></div><script type="text/javascript">Fluid.utils.loadComments("#SOHUCS",function(){Fluid.utils.createScript("https://changyan.sohu.com/upload/changyan.js",function(){window.changyan.api.config({appid:"cyvF6OB0j",appkey:"prod_b5f6e7613498e69aaefd2d441861390a"})})})</script><noscript>Please enable JavaScript to view the comments</noscript></article></article></div></div></div><div class="side-col d-none d-lg-block col-lg-2"><aside class="sidebar" style="margin-left:-1rem"><div id="toc"><p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;ç›®å½•</p><div class="toc-body" id="toc-body"></div></div></aside></div></div></div><a id="scroll-top-button" aria-label="TOP" href="#" role="button"><i class="iconfont icon-arrowup" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">æœç´¢</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">å…³é”®è¯</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div><div class="col-lg-7 mx-auto nopadding-x-md"><div class="container custom mx-auto"><style>.katex-html{display:none!important}.katex-mathml{display:inline-block!important}.katex-display{margin:1em 0!important;text-align:center!important;overflow:auto hidden!important}.katex{font-size:1.1em!important;line-height:1.2!important}</style></div></div></main><footer><div class="footer-inner"><div class="footer-content"><a href="https://jinbilianshao.github.io/xiaoxin" target="_blank" rel="nofollow noopener"><span>ç‰ˆæƒæ‰€æœ‰è€…ï¼šè¿æ€é‘«</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a></div><div class="statistics"><span id="busuanzi_container_site_pv" style="display:none">æ€»è®¿é—®é‡ <span id="busuanzi_value_site_pv"></span> æ¬¡ </span><span id="busuanzi_container_site_uv" style="display:none">æ€»è®¿å®¢æ•° <span id="busuanzi_value_site_uv"></span> äºº</span></div></div></footer><script src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js"></script><link rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css"><script>NProgress.configure({showSpinner:!1,trickleSpeed:100}),NProgress.start(),window.addEventListener("load",function(){NProgress.done()})</script><script src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js"></script><script src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js"></script><script src="/js/events.js"></script><script src="/js/plugins.js"></script><script src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js"></script><script>!function(t){var e=Fluid.plugins.typing,i=t.getElementById("subtitle");i&&e&&e(i.getAttribute("data-typed-text"))}((window,document))</script><script src="/js/img-lazyload.js"></script><script>Fluid.utils.createScript("https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js",function(){var t,o=jQuery("#toc");0!==o.length&&window.tocbot&&(t=jQuery("#board-ctn").offset().top,window.tocbot.init({tocSelector:"#toc-body",contentSelector:".markdown-body",headingSelector:CONFIG.toc.headingSelector||"h1,h2,h3,h4,h5,h6",linkClass:"tocbot-link",activeLinkClass:"tocbot-active-link",listClass:"tocbot-list",isCollapsedClass:"tocbot-is-collapsed",collapsibleClass:"tocbot-is-collapsible",collapseDepth:CONFIG.toc.collapseDepth||0,scrollSmooth:!0,headingsOffset:-t}),0<o.find(".toc-list-item").length&&o.css("visibility","visible"))})</script><script>!function(){var i,t=CONFIG.code_language.enable&&CONFIG.code_language.default,c=CONFIG.copy_btn;(t||c)&&(i="",i+='<div class="code-widget">',i+="LANG",i+="</div>",jQuery(".markdown-body pre").each(function(){var e,a,n=jQuery(this);0<n.find("code.mermaid").length||0<n.find("span.line").length||(e="",t&&(e=CONFIG.code_language.default,0<n[0].children.length&&2<=n[0].children[0].classList.length&&n.children().hasClass("hljs")?e=n[0].children[0].classList[1]:n[0].getAttribute("data-language")?e=n[0].getAttribute("data-language"):n.parent().hasClass("sourceCode")&&0<n[0].children.length&&2<=n[0].children[0].classList.length?(e=n[0].children[0].classList[1],n.parent().addClass("code-wrapper")):n.parent().hasClass("markdown-body")&&0===n[0].classList.length&&n.wrap('<div class="code-wrapper"></div>'),e=e.toUpperCase().replace("NONE",CONFIG.code_language.default)),n.append(i.replace("LANG",e).replace('code-widget">',(a=n[0],(0<=Fluid.utils.getBackgroundLightness(a)?"code-widget-light":"code-widget-dark")+(c?' code-widget copy-btn" data-clipboard-snippet><i class="iconfont icon-copy"></i>':' code-widget">')))),c&&Fluid.utils.createScript("https://lib.baomitu.com/clipboard.js/2.0.10/clipboard.min.js",function(){new window.ClipboardJS(".copy-btn",{target:function(e){for(var a=e.parentNode.childNodes,n=0;n<a.length;n++)if("CODE"===a[n].tagName)return a[n]}}).on("success",function(e){e.clearSelection(),e.trigger.innerHTML=e.trigger.innerHTML.replace("icon-copy","icon-success"),setTimeout(function(){e.trigger.innerHTML=e.trigger.innerHTML.replace("icon-success","icon-copy")},2e3)})}))}))}()</script><script>Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));
  });</script><script>Fluid.utils.createScript("https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js",function(){Fluid.plugins.fancyBox()})</script><script>Fluid.plugins.imageCaption()</script><script src="/js/local-search.js"></script><script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="/js/boot.js"></script><noscript><div class="noscript-warning">åšå®¢åœ¨å…è®¸ JavaScript è¿è¡Œçš„ç¯å¢ƒä¸‹æµè§ˆæ•ˆæœæ›´ä½³</div></noscript><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,debug:!1,model:{scale:1,hHeadPos:.5,vHeadPos:.618,jsonPath:"/live2dw/assets/shizuku.model.json"},display:{position:"right",width:150,height:300,hOffset:0,vOffset:-20},mobile:{show:!0,scale:.5},react:{opacityDefault:.7,opacityOnHover:.9},log:!1})</script></body></html>